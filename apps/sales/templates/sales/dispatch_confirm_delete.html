{% extends 'accounts/base.html' %}
{% load static %}

{% block title %}Delete Dispatch - Chesanto Bakery{% endblock %}

{% block content %}
<style>
    .delete-card {
        max-width: 600px;
        margin: 2rem auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        padding: 2rem;
    }
    
    .delete-icon {
        width: 64px;
        height: 64px;
        background: #fee;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
    }
    
    .delete-icon svg {
        width: 32px;
        height: 32px;
        color: #dc2626;
    }
    
    .dispatch-summary {
        background: #f9fafb;
        border-radius: 8px;
        padding: 1rem;
        margin: 1.5rem 0;
    }
    
    .dispatch-summary-item {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
        border-bottom: 1px solid #e5e7eb;
    }
    
    .dispatch-summary-item:last-child {
        border-bottom: none;
    }
    
    .warning-box {
        background: #fef3c7;
        border: 1px solid #f59e0b;
        border-radius: 8px;
        padding: 1rem;
        margin: 1.5rem 0;
        display: flex;
        gap: 0.75rem;
    }
    
    .warning-box svg {
        width: 20px;
        height: 20px;
        color: #f59e0b;
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    .button-group {
        display: flex;
        gap: 1rem;
        margin-top: 2rem;
    }
    
    .button-group button,
    .button-group a {
        flex: 1;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-weight: 500;
        text-align: center;
        text-decoration: none;
        border: none;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .btn-cancel {
        background: #f3f4f6;
        color: #374151;
    }
    
    .btn-cancel:hover {
        background: #e5e7eb;
    }
    
    .btn-delete {
        background: #dc2626;
        color: white;
    }
    
    .btn-delete:hover {
        background: #b91c1c;
    }
</style>

<div class="delete-card">
    <div class="delete-icon">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
    </div>
    
    <h2 style="text-align: center; margin-bottom: 0.5rem; font-size: 1.5rem; color: #111827;">
        Delete Dispatch?
    </h2>
    
    <p style="text-align: center; color: #6b7280; margin-bottom: 1.5rem;">
        This action cannot be undone. All products and crates will be restored to stock.
    </p>
    
    <div class="dispatch-summary">
        <h3 style="font-size: 0.875rem; font-weight: 600; color: #6b7280; margin-bottom: 0.75rem; text-transform: uppercase;">
            Dispatch Details
        </h3>
        
        <div class="dispatch-summary-item">
            <span style="color: #6b7280;">Date</span>
            <span style="font-weight: 500;">{{ dispatch.date|date:"F d, Y" }}</span>
        </div>
        
        <div class="dispatch-summary-item">
            <span style="color: #6b7280;">Salesperson</span>
            <span style="font-weight: 500;">{{ dispatch.salesperson.name }}</span>
        </div>
        
        <div class="dispatch-summary-item">
            <span style="color: #6b7280;">Crates</span>
            <span style="font-weight: 500;">{{ dispatch.crates_dispatched }}</span>
        </div>
        
        <div class="dispatch-summary-item">
            <span style="color: #6b7280;">Expected Revenue</span>
            <span style="font-weight: 600; color: #059669;">KES {{ dispatch.expected_revenue|floatformat:2 }}</span>
        </div>
    </div>
    
    <div style="background: #f9fafb; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
        <h4 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">Products to be restored:</h4>
        {% for item in dispatch.dispatchitem_set.all %}
        <div style="display: flex; justify-content: space-between; padding: 0.25rem 0;">
            <span>{{ item.product.name }}</span>
            <span style="font-weight: 500;">{{ item.quantity }} packets</span>
        </div>
        {% endfor %}
    </div>
    
    <div class="warning-box">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
        <div>
            <p style="font-weight: 500; color: #92400e; margin-bottom: 0.25rem;">
                Warning
            </p>
            <p style="color: #78350f; font-size: 0.875rem;">
                {{ warning_message }}
            </p>
        </div>
    </div>
    
    <form method="post" style="margin: 0;">
        {% csrf_token %}
        
        <div class="button-group">
            <a href="{% url 'sales:dispatch_detail' dispatch.id %}" class="btn-cancel">
                Cancel
            </a>
            <button type="submit" class="btn-delete">
                Delete Dispatch
            </button>
        </div>
    </form>
</div>
{% endblock %}
